<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>孔孟之道--登陆</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css" />
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <link rel="stylesheet" href="./css/iconfont/iconfont.css">
    <link rel="stylesheet" href="./css/iconfont.css">
    <style>
        html,body {
          /*min-height: 100%;*/
          background-image: url(./image/aloud/7894654165.png);
          background-size: 100% 100%;
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
        .p20px{padding: 0 40px;}
        .fl{float: left;}
        .fr{float: right;}
        .clr{clear: both;}
        #footer{
            width: 100%;
            height: 150px;
            position: absolute;
            bottom: 0;
        }
        #footer .login_wx{
          width: 200px;
          height: 40px;
          border-radius: 20px;
          background-color: #89211b;
          margin: 0 auto;
          text-align: center;
          line-height: 40px;
          color: #fff;
        }
        .login_footer{padding: 20px 0;}
        .login_qq,.login_sj{color: #89211b;}
    </style>
</head>
<body>
  <div id="footer">
    <div class="login_wx">
      微信登录
    </div>
    <div class="login_footer">
      <div class="p20px">
        <div class="login_qq fl" onclick="fnQQLogin();">QQ登录 ></div>
        <div class="login_sj fr" onclick="fnSjWin();">手机号登录 ></div>
        <div class="clr"></div>
      </div>
    </div>
  </div>
</body>

</html>
<script type="text/javascript" src="script/api.js"></script>
<!-- <script type="text/javascript" src="script/index.js"></script> -->
<script type="text/javascript">
    apiready = function() {

    }
    function fnqqDl() {

    }
    function fnSjWin() {
      api.openWin({
          name: 'login_user',
          url: 'login_user.html',
          pageParam: {
              name: 'test'
          }
      });

    }
    function fnQQLogin() {
      var qq = api.require('qq');
      var login = function() {
        qq.login(function(ret, err) {
          var openId = ret.openId;
          var accessToken = ret.accessToken;
          if(ret.status){
            api.alert({
                title: '授权成功',
                msg: '正在打开孔孟知道...',
            }, function(ret, err){
                if( ret ){
                     //alert( JSON.stringify( ret ) );
                     qq.getUserInfo(function(ret,err) {
                        if (ret.status) {
                          //console.log(JSON.stringify(ret.info));
                             //alert(JSON.stringify(ret));
                           var qqziliao = ret.info;
                           api.openWin({
                               name: 'index',
                               url: './index.html',
                               pageParam: {
                                   name: 'test',
                                   qqziliao: qqziliao
                               }
                           });
                        }else{
                             alert(JSON.stringify(err));
                        }
                     });
                }else{
                     alert( JSON.stringify( err ) );
                }
            });
          }else {
              //var toast = new auiToast();
              // var toast.fail({
              //     title: "授权失败",
              //     duration: 1500
              // });
          }
        });
      };
      qq.installed(function(ret, err) {
        if (ret.status) {
          login();
        } else {
          api.alert({
            msg : "当前设备未安装QQ客户端"
          });
        }
      });
    };

</script>
