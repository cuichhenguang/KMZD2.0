<!DOCTYPE HTML>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title></title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" href="../css/swiper.min.css">
    <style>
        html,
        body {
            height: 100%;
        }

        #wrap {
            height: 100%;
            background: url(../image/img/play_bg_tra.jpg) no-repeat;
            background-size: 100% 100%;
            -webkit-background-size: cover;
            background-size: cover;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-orient: vertical;
            -webkit-flex-flow: column;
            flex-flow: column;
        }

        #main {
            position: relative;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
        }

        header {
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            height: 50px;
        }

        header div {
            font-size: 14px;
            color: #fff;
            text-align: center;
            line-height: 49px;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
        }

        header i {
            display: block;
            width: 53px;
            height: 49px;
        }

        header .back {
            background: url(../image/img/navi_back.png) no-repeat;
            -webkit-background-size: contain;
            background-size: contain;

        }

        header .more {
            background: url() no-repeat;
            -webkit-background-size: contain;
            background-size: contain;
        }

        #action {
            margin-bottom: 10px;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
        }

        #action li {
            text-align: center;
            color: #cbcbcb;
            font-size: 12px;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            padding-top: 30px;
            background-position: center top;
            background-repeat: no-repeat;
            -webkit-background-size: 25px;
            background-size: 25px;
        }

        #action .collect {
            text-align: center;
            color: #cbcbcb;
            font-size: 12px;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            padding-top: 0px;
            background-position: center top;
            background-repeat: no-repeat;
            -webkit-background-size: 25px;
            background-size: 25px;
        }

        #action .timer {
            background-image: url(../image/play_choice.png);
        }

        /*#action .timer.focus {
            background-image: url(../image/play_choice.png);
        }*/

        #action .share {
            background-image: url(../image/img/ic_play_share.png);
        }

        /*#action .share.focus {
            background-image: url(../image/img/ic_play_share_s.png);
        }*/

        #action .checkin {
            background-image: url(../image/discuss.png);
        }

        /*#action .checkin.focus {
            background-image: url(../image/play_discuss.png);
        }*/

        #control {
            /*background-color: #672d32;*/
        }

        #slider {
            height: 50px;
            position: relative;
        }

        #slider span {
            position: absolute;
            bottom: 0;
            font-size: 12px;
            color: #ccc;
        }

        #slider .s {
            left: 10px;
        }

        #slider .e {
            right: 10px;
        }

        #panel {
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            padding: 30px 0 40px;
        }

        #panel li {
            width: 30px;
            height: 30px;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            background-position: center;
            background-repeat: no-repeat;
            -webkit-background-size: 30px;
            background-size: 30px;
        }

        #panel .list {
            background-image: url(../image/img/ic_play_schedule.png);
            -webkit-background-size: 25px;
            background-size: 25px;
        }

        /*#panel .list.focus {
            background-image: url(../image/img/ic_play_schedule_s.png);
        }*/

        #panel .prev {
            background-image: url(../image/img/ic_play_pre.png);
        }

        /*#panel .prev.focus {
            background-image: url(../image/img/ic_play_pre_s.png);
        }*/

        #panel .play {
            background-image: url(../image/img/ic_play_play.png);
        }

        /*#panel .play.focus {
            background-image: url(../image/img/ic_play_play_s.png);
        }*/

        #panel .pause {
            background-image: url(../image/img/ic_play_pause.png);
        }

        /*#panel .pause.focus {
            background-image: url(../image/img/ic_play_pause_s.png);
        }*/

        #panel .buffer {
            background-image: none;
        }

        @-webkit-keyframes rotate {
            from {
                -webkit-transform: rotate(0deg);
            }
            to {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        #panel .buffer:before {
            content: '';
            display: inline-block;
            width: 100%;
            height: 100%;
            background: url(../image/img/ic_play_buffer.png) no-repeat center;
            -webkit-background-size: contain;
            background-size: contain;
            -webkit-animation: rotate 4s linear infinite;
            animation: rotate 4s linear infinite;
        }

        /*#panel .buffer.focus {
            background-image: url(../image/img/ic_play_buffer_s.png);
        }*/

        #panel .next {
            background-image: url(../image/img/ic_play_next.png);
        }

        /*#panel .next.focus {
            background-image: url(../image/img/ic_play_next_s.png);
        }*/

        #panel .download {
            background-image: url(../image/play_choice.png);
        }

        /*#panel .download.focus {
            background-image: url(../image/play_choice.png);
        }*/

        #chat {
            overflow: hidden;
            border-top: 1px solid #845253;
        }

        #chat a {
            float: right;
            padding: 10px;
            font-size: 12px;
            color: #ccc;
        }

        #main .wrap {
            position: absolute;
            margin: auto;
            width: 100%;
            bottom: 0;
            top: 0;
            height: 60px;
        }

        #main h1 {
            font-size: 20px;
            color: #fff;
            text-align: center;
        }

        #main label {
            display: block;
            text-align: center;
            font-size: 14px;
            color: #ccc;
            padding-top: 20px;
        }
        /*轮播图        */

        .swiper-container {
            width: 100%;
            text-align: center;
            height: 300px;
            margin-top: 75px;
        }

        .swiper-container img {
            width: 240px;
            /*margin-top: 50px;*/
        }
        #secHeader{
          width: 100%;
          height: 50px;
          background-image: url(../image/img/header.png);
          background-repeat: no-repeat;
          background-size: 100% 100%;
        }

    </style>
</head>

<body id="body">
    <div id="wrap" class="mh">
        <!-- <img src="" alt=""> -->
        <header class="qx" id="secHeader">
            <i class="back" tapmode onclick="api.closeWin();"></i>
            <div>三字经</div>
            <i class="more"></i>
        </header>
        <div id="main" class="qx">

            <div class="swiper-container">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <img src="../image/poster.png" alt="">
                    </div>
                    <div class="swiper-slide">
                        <div class="play-txt">
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                            <p>解：利西南；</p>
                            <p>无所往，其来复吉；</p>
                            <p>有攸往，夙吉。</p>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="play-list">
                            <p>1152 周易上经 乾卦第一.mp3</p>
                            <p>1153 周易上经 坤卦第二.mp3</p>
                            <p>1154 周易上经 屯卦第三.mp3</p>
                            <p>1155 周易上经 蒙卦第四.mp3</p>
                            <p>1156 周易上经 需卦第五.mp3</p>
                            <p>1157 周易上经 讼卦第六.mp3</p>
                            <p>1158 周易上经 师卦第七.mp3</p>
                            <p>1159 周易上经 比卦第八.mp3</p>
                            <p>1160 周易上经 小畜卦第九.mp3</p>
                            <p>1161 周易上经 履卦第十.mp3</p>
                            <p>1162 周易上经 泰卦第十一.mp3</p>
                            <p>1163 周易上经 否卦第十二.mp3</p>
                            <p>1164 周易上经 同人卦第十三.mp3</p>
                            <p>1165 周易上经 大有卦第十四.mp3</p>
                            <p>1166 周易上经 谦卦第十五.mp3</p>
                            <p>1167 周易上经 豫卦第十六.mp3</p>
                            <p>1168 周易上经 随卦第十七.mp3</p>
                            <p>1169 周易上经 蛊卦第十八.mp3</p>
                            <p>1170 周易上经 临卦第十九.mp3</p>
                            <p>1171 周易上经 观卦第二十.mp3</p>
                            <p>1172 周易上经 噬嗑卦第二十一.mp3</p>
                            <p>1173 周易上经 贲卦第二十二.mp3</p>
                            <p>1174 周易上经 剥卦第二十三.mp3</p>
                            <p>1175 周易上经 复卦第二十四.mp3</p>
                            <p>1176 周易上经 无妄卦第二十五.mp3</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <ul id="action" class="qx">
            <li class="collect">
                <img src="../image/play_collect.png" alt="" id="playCollect" onclick="fnOpenPlayCollect();">
                <p>收藏</p>
            </li>
            <li class="timer" tapmode="focus" onclick="fnOpenChoicePlayer();">切换国学机</li>
            <li class="share" tapmode="focus" onclick="fnOpenPlayShare();">分享</li>
            <li class="checkin" tapmode="focus" onclick="fnOpenPlayDiscuss();">评论</li>
        </ul>
        <div id="control" class="qx">
            <div id="slider">
                <span class="s">13:00:00</span>
                <span class="e">14:00:00</span>
            </div>
            <ul id="panel">
                <li class="list" tapmode="focus" onclick="openRadioList()"></li>
                <li class="prev" tapmode="focus" onclick="prevRadio()"></li>
                <li class="play" tapmode="focus" onclick="playRadio(this)"></li>
                <li class="next" tapmode="focus" onclick="nextRadio()"></li>
                <li><img src="../image/play_change0.png" alt="" id="img"></li>
            </ul>
        </div>
    </div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<!-- <script type="text/javascript" src="../script/api-lite.js"></script> -->
<script type="text/javascript" src="../script/zepto.js"></script>
<script type="text/javascript" src="../script/swiper.min.js"></script>
<script type="text/javascript">
    var radios = ['see_you_again', 'new_soul', 'i_am_you'];
    var i = 0;

    // 进度条
    var time1;

    function a() {
        var pg = document.getElementById('pg')
        time1 = setInterval(function(e) {
            if (pg.value != 100) pg.value++;
            //else pg.value=0;
        }, 200);
    }

    function b() {
        clearInterval(time1);
    }

    function playRadio(it) {
        if ($(it).hasClass('pause')) {
            $(it).removeClass().addClass('play');
            api.stopPlay();
        } else {
            $(it).removeClass().addClass('buffer');
            setTimeout(function() {
                $(it).removeClass().addClass('pause');
                var radio = radios[i];
                api.startPlay({
                    path: 'widget://res/' + radio + '.mp3'
                }, function() {
                    // api.alert({msg: '播放完成'});
                });
            }, 500);

        }

    }
    //  alert(JSON.stringify(it));
    //  alert(it)
    // 向左播放减一
    function prevRadio() {
        i--;
        if (i <= 0) {
            i = 0;
        }
        var radio = radios[i];
        api.stopPlay();
        api.startPlay({
            path: 'widget://res/' + radio + '.mp3'
        }, function() {
            // api.alert({msg: '播放完成'});
        });
    }
    // 向右播放加一
    function nextRadio() {
        i++;
        if (i > 2) {
            i = 0;
        }
        var radio = radios[i];
        api.stopPlay();
        api.startPlay({
            path: 'widget://res/' + radio + '.mp3'
        }, function() {
            // api.alert({msg: '播放完成'});
        });
    }
    document.getElementById('body').onkeydown = function(){
      var secHeader = $api.byId('secHeader');
      $api.fixStatusBar(secHeader);
      var headerH = $api.offset(secHeader).h;
      var header = document.querySelector('header');
      $api.fixIos7Bar(header);

      var $slider = $('#slider');
      var sliderPos = $slider.offset();
      var obj = api.require('slider');
      obj.open({
          x: 0,
          y: sliderPos.top + 10,
          w: api.winWidth,
          bgImg: "widget://image/slider/slider-bg.png",
          selectedBgImg: "widget://image/slider/slider-fg.png",
          bar: {
              barWidth: 20,
              barHeight: 20,
              barImg: "widget://image/slider/slider-btn.png"
          },
          bubble: {
              bubbleWidth: 0,
              bubbleHeight: 0
          },
          minValue: 0,
          maxValue: 100,
          defValue: 0,
          fixed: true
              // value:values
      }, function(ret, err) {
          // var slider = api.require('slider');
          // slider.setValue({
          //     id: 1,
          //     value: 51
          // });
          // alert(JSON.stringify( ret ));
          console.log(JSON.stringify(ret));
          if (ret.touchCancel) {
              // api.alert({msg:ret.value});
          }
      });
      fnInitSwiper();
      fnOpenChangeImg();
    }
    apiready = function() {
        var secHeader = $api.byId('secHeader');
        $api.fixStatusBar(secHeader);
        var headerH = $api.offset(secHeader).h;
        var header = document.querySelector('header');
        $api.fixIos7Bar(header);

        var $slider = $('#slider');
        var sliderPos = $slider.offset();
        var obj = api.require('slider');

        obj.open({
            x: 0,
            y: sliderPos.top + 10,
            w: api.winWidth,
            bgImg: "widget://image/slider/slider-bg.png",
            selectedBgImg: "widget://image/slider/slider-fg.png",
            bar: {
                barWidth: 20,
                barHeight: 20,
                barImg: "widget://image/slider/slider-btn.png"
            },
            bubble: {
                bubbleWidth: 0,
                bubbleHeight: 0
            },
            minValue: 0,
            maxValue: 100,
            defValue: 0,
            fixed: true
                // value:values
        }, function(ret, err) {
            // var slider = api.require('slider');
            // slider.setValue({
            //     id: 1,
            //     value: 51
            // });
            // alert(JSON.stringify( ret ));
            console.log(JSON.stringify(ret));
            if (ret.touchCancel) {
                // api.alert({msg:ret.value});
            }
        });
        fnInitSwiper();
        fnOpenChangeImg();
    };
    // 轮播
    function fnInitSwiper() {
        var mySwiper = new Swiper('.swiper-container', {
            autoplay: false,
            loop: true,
        });
    };
    // 切换单曲循环、顺序播放、随机播放
    function fnOpenChangeImg() {
        var image_urls = ["../image/play_change0.png", "../image/play_change1.png", "../image/play_change2.png"];
        // 初始化数组键值 (0 = 第一个图片)
        var idx = 0;
        // 点击 id 为 img 的图片
        document.getElementById("img").onclick = function() {
            // idx + 1，如果为最后一张，还原回第一张
            idx = idx === image_urls.length - 1 ? 0 : idx + 1;
            // 设置 src
            this.src = image_urls[idx];
            // 测试
            // alert(this.src);
        };
        // var imgs = document.getElementById('imgBox').getElementsByTagName('img');
        // for(var i=0;i<=imgs.length;i++){
        //   if(i==num+1){
        //      imgs[i].style.display="inline";
        //   }else{
        //     imgs[i].style.display="none";
        //   };
        //   if(num==2){
        //     imgs[0].style.display="inline";
        //   };
        // }
    };
    // 选择播放器
    function fnOpenChoicePlayer() {
        api.openWin({
            name: 'choicePlayer',
            url: './choice_player.html',
        });
    };
    // 收藏
    function fnOpenPlayCollect() {
        var playCollect = $api.byId('playCollect');
        if (playCollect.getAttribute("src", 2) == "../image/play_collect.png") {
            playCollect.src = "../image/play_collect0.png";
        } else {
            playCollect.src = "../image/play_collect.png";
        }
    };
    // 打开评论页面
    function fnOpenPlayDiscuss() {
        api.openWin({
            name: 'playDiscuss',
            url: './play_discuss.html',
        })
    }
    //打开分享
    function fnOpenPlayShare() {
        var dialogBox = api.require('dialogBox');
        dialogBox.actionMenu({
            rect: {
                h: 150
            },
            texts: {
                cancel: '取消'
            },
            items: [{
                text: '微信',
                icon: 'widget://image/weixin.png'
            }, {
                text: 'QQ',
                icon: 'widget://image/qq.png'
            }, {
                text: '朋友圈',
                icon: 'widget://image/friends.png'
            }],
            styles: {
                bg: '#FFF',
                column: 3,
                itemText: {
                    color: '#000',
                    size: 12,
                    marginT: 8
                },
                itemIcon: {
                    size: 48
                },
                cancel: {
                    bg: 'fs://icon.png',
                    color: '#000',
                    h: 44,
                    size: 14
                }
            }
        }, function(ret) {
            dialogBox.close({
                dialogName: 'alert'
            })
        });
    }
    //打开播放列表
    function openRadioList() {
        var height = api.frameHeight + 50;
        api.openFrame({
            name: 'play_radiolist',
            url: './play_radiolist.html',
            bounces: false,
            bgColor: 'rgba(0,0,0,0.6)',
            rect: {
                x: 0,
                y: 0,
                w: api.frameWidth,
                h: height
            }
        });
    }
</script>

</html>
